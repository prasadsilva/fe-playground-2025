import{r,d as I,a as A,j as i}from"./index-BXobHPcc.js";const v={Clubs:0,Diamonds:1,Hearts:2,Spades:3},L="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2C'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SC2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M30%20150C35%20385%2085%20400%20130%20500L-130%20500C-85%20400%20-35%20385%20-30%20150A10%2010%200%200%200%20-50%20150A210%20210%200%201%201%20-124%20-51A10%2010%200%200%200%20-110%20-65A230%20230%200%201%201%20110%20-65A10%2010%200%200%200%20124%20-51A210%20210%200%201%201%2050%20150A10%2010%200%200%200%2030%20150Z'%20fill='black'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VC2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='black'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VC2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='70'%20width='70'%20x='-35'%20y='-135.588'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VC2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='70'%20width='70'%20x='-35'%20y='-135.588'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",f="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2D'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SD2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-400%200C-350%200%200%20-450%200%20-500C0%20-450%20350%200%20400%200C350%200%200%20450%200%20500C0%20450%20-350%200%20-400%200Z'%20fill='red'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VD2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='red'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VD2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VD2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",M="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2H'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SH2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M0%20-300C0%20-400%20100%20-500%20200%20-500C300%20-500%20400%20-400%20400%20-250C400%200%200%20400%200%20500C0%20400%20-400%200%20-400%20-250C-400%20-400%20-300%20-500%20-200%20-500C-100%20-500%200%20-400%20-0%20-300Z'%20fill='red'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VH2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='red'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VH2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VH2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",P="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2S'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SS2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M0%20-500C100%20-250%20355%20-100%20355%20185A150%20150%200%200%201%2055%20185A10%2010%200%200%200%2035%20185C35%20385%2085%20400%20130%20500L-130%20500C-85%20400%20-35%20385%20-35%20185A10%2010%200%200%200%20-55%20185A150%20150%200%200%201%20-355%20185C-355%20-100%20-100%20-250%200%20-500Z'%20fill='black'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VS2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='black'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VS2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VS2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3c/g%3e%3c/svg%3e";class E{trackedObjDragMoveCallback;trackedObjDragEndCallback;canvasPointerClientX;canvasPointerClientY;usageCount;currentDragData;dragStateChangeListeners;dropCallback;constructor(e){this.trackedObjDragMoveCallback=void 0,this.trackedObjDragEndCallback=void 0,this.canvasPointerClientX=-1,this.canvasPointerClientY=-1,this.usageCount=0,this.currentDragData=null,this.dragStateChangeListeners=new Set,this.dropCallback=e}setDragData(e){this.currentDragData=e,this.dragStateChangeListeners.forEach(a=>a(this.currentDragData))}addDragStateChangeListener(e){this.dragStateChangeListeners.add(e),this.usageCount===0&&document.body.addEventListener("pointermove",this.trackCanvasPointer),this.usageCount++}removedragStateChangeListener(e){this.dragStateChangeListeners.delete(e),this.usageCount--,this.usageCount===0&&document.body.removeEventListener("pointermove",this.trackCanvasPointer)}trackCanvasPointer=e=>{const a=e.clientX-this.canvasPointerClientX,s=e.clientY-this.canvasPointerClientY;this.trackedObjDragMoveCallback&&this.trackedObjDragMoveCallback(a,s),this.canvasPointerClientX=e.clientX,this.canvasPointerClientY=e.clientY};registerPointerReleaseCallbacks=()=>{document.body.addEventListener("pointerup",this.handlePointerReleaseNative),document.body.addEventListener("pointerleave",this.handlePointerInvalidNative),document.body.addEventListener("pointercancel",this.handlePointerInvalidNative)};unregisterPointerReleaseCallbacks=()=>{document.body.removeEventListener("pointerup",this.handlePointerReleaseNative),document.body.removeEventListener("pointerleave",this.handlePointerInvalidNative),document.body.removeEventListener("pointercancel",this.handlePointerInvalidNative)};handlePointerReleaseNative=e=>{this.currentDragData&&this.dropCallback(this.currentDragData),this.clearActiveDragHandler()};handlePointerInvalidNative=e=>{this.clearActiveDragHandler()};setActiveDragHandler=(e,a,s)=>{if(this.trackedObjDragMoveCallback){console.warn("Already in drag mode");return}this.trackedObjDragMoveCallback=a,this.trackedObjDragEndCallback=s,this.registerPointerReleaseCallbacks(),this.setDragData(e)};clearActiveDragHandler=()=>{if(!this.trackedObjDragMoveCallback){console.warn("Unable to clear drag object. Not currently dragging an element.");return}this.trackedObjDragMoveCallback=void 0,this.trackedObjDragEndCallback&&this.trackedObjDragEndCallback(),this.trackedObjDragEndCallback=void 0,this.unregisterPointerReleaseCallbacks(),this.setDragData(null)}}class T{cardStacks;changeListeners;dragManager;activeDropTarget;canvasElement;constructor(e){this.cardStacks=I(e),this.changeListeners=new Set,this.dragManager=new E(a=>this.tryHandleDrop(a)),this.activeDropTarget=null,this.canvasElement=null}getCanvas(){return this.canvasElement}setCanvas(e){this.canvasElement=e}getCardStacks(){return this.cardStacks}setActiveDragHandler(e,a,s){this.dragManager.setActiveDragHandler(e,a,s)}addDragStateChangeListener(e){this.dragManager.addDragStateChangeListener(e)}removeDragStateChangeListener(e){this.dragManager.removedragStateChangeListener(e)}setActiveDropTarget(e){this.activeDropTarget=e}clearActiveDropTarget(){this.activeDropTarget=null}tryHandleDrop(e){this.activeDropTarget?(this.moveBetweenStacks(e.stackInfo,this.activeDropTarget),this.notifyContextStateChange(!0)):this.notifyContextStateChange(!1),this.clearActiveDropTarget()}addChangeListener(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}notifyContextStateChange(e){this.changeListeners.forEach(a=>a(e))}moveBetweenStacks(e,a){const s=this.cardStacks.findIndex(g=>g.stackId===e.stackId);if(s===-1){console.warn("Unable to move card. Source stack is invalid");return}const c=this.cardStacks.findIndex(g=>g.stackId===a.stackId);if(c===-1){console.warn("Unable to move card. Target stack is invalid");return}const n=[...this.cardStacks],o={...this.cardStacks[s]},l=o.cards.slice(0,e.cardIndex),d=o.cards.slice(e.cardIndex);l.length===o.cards.length&&console.warn("Something went wrong with card removal"),o.cards=l,n[s]=o;const h={...this.cardStacks[c]},u=[...h.cards];u.splice(a.cardIndex,0,...d);for(let g=0;g<u.length;g++){const C={...u[g]};C.stackInfo={stackId:a.stackId,cardIndex:g},u[g]=C}h.cards=u,n[c]=h,this.cardStacks=n}}const m=t=>new T(t),p=r.createContext(m([]));function j(){const t=r.useContext(p),[e,a]=r.useState(t.getCardStacks()),s=r.useCallback(c=>{a(c?t.getCardStacks():[...t.getCardStacks()])},[t]);return r.useEffect(()=>(t.addChangeListener(s),()=>t.removeChangeListener(s)),[t]),{cardStacks:e}}function w(){const t=r.useContext(p),[e,a]=r.useState(null),s=r.useCallback(l=>{a(l)},[]);r.useEffect(()=>(t.addDragStateChangeListener(s),()=>t.removeDragStateChangeListener(s)),[t]);const c=r.useCallback((l,d,h)=>{t.setActiveDragHandler(l,d,h)},[t]),n=r.useCallback(l=>{t.setActiveDropTarget(l)},[t]),o=r.useCallback(l=>{t.clearActiveDropTarget()},[t]);return{activeDragCard:e,setActiveDrag:c,setActiveDrop:n,unsetActiveDrop:o}}function R(t){const e=r.useRef(null),{activeDragCard:a,setActiveDrop:s,unsetActiveDrop:c}=w(),[n,o]=r.useState(!1),l=r.useMemo(()=>a&&a.stackInfo.stackId!==t.stackId,[a,t]);return r.useEffect(()=>{const d=e.current;if(d){const h=()=>{l&&(o(!0),s(t))},u=()=>{l&&(o(!1),c(t))};return d.addEventListener("pointerenter",h),d.addEventListener("pointerleave",u),()=>{d.removeEventListener("pointerenter",h),d.removeEventListener("pointerleave",u)}}},[e.current,l,t]),r.useEffect(()=>{a||o(!1)},[a]),{dropTargetRef:e,isActivated:l,isDragOver:n}}function H(t,e,a){const s=r.useCallback(d=>{if(d){const h=()=>{n(!0),o(t,e,l)};return d.addEventListener("pointerdown",h),()=>{d.removeEventListener("pointerdown",h)}}},[]),[c,n]=r.useState(!1),{setActiveDrag:o}=x.useDragManager(),l=r.useCallback(()=>{n(!1),a()},[a]);return{draggableRef:s,isBeingDragged:c}}function O(){const t=r.useContext(p),[e,a]=r.useState(!1);return{canvasRef:r.useCallback(n=>{if(t.getCanvas()&&n){console.warn("Unable to register canvas element. A canvas is already registered.");return}t.setCanvas(n),a(n!==null)},[]),isCanvasAvailable:e,createCanvasPortal:n=>{const o=t.getCanvas();return o!==null?A.createPortal(n,o):null}}}const x={useModel:j,useDragManager:w,useDropTarget:R,useDraggable:H,useCanvas:O},N="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='card'%20face='outline'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='%23aaaaaa33'%20stroke='black'%3e%3c/rect%3e%3c/svg%3e";function B({stackInfo:t,position:e,...a}){const{dropTargetRef:s,isActivated:c,isDragOver:n}=x.useDropTarget(t);return i.jsx("div",{...a,ref:s,className:"absolute h-36 w-fit",style:{left:`${e.x}px`,top:`${e.y}px`,zIndex:t.cardIndex,opacity:c&&n?.4:0,pointerEvents:c?"auto":"none"},children:i.jsx("img",{src:N,className:"h-full"})})}const y=24;function Y({cardStack:t,cardIdx:e,position:a,isPreviousSiblingBeingDragged:s,...c}){const[n,o]=r.useState({x:a.x,y:a.y}),l=r.useCallback(()=>{o(a)},[a]),d=r.useCallback((b,S)=>{o(k=>({x:k.x+b,y:k.y+S}))},[]),{draggableRef:h,isBeingDragged:u}=x.useDraggable(t.cards[e],d,l);r.useEffect(()=>{l()},[a]);const g=r.useMemo(()=>s||u,[s,u]),C=r.useMemo(()=>({x:n.x,y:n.y+y}),[n]);return i.jsxs(i.Fragment,{children:[i.jsx("div",{...c,ref:h,className:"absolute h-36",style:{transform:`translateX(${n.x}px) translateY(${n.y}px)`,zIndex:g?e+100:e,pointerEvents:g?"none":"auto"},children:i.jsx("img",{src:t.cards[e].descriptor.cardImg,className:"h-full",draggable:!1})}),i.jsx(D,{cardStack:t,cardIdx:e+1,position:C,isPreviousSiblingBeingDragged:g})]})}function D({cardStack:t,cardIdx:e,position:a,isPreviousSiblingBeingDragged:s,...c}){return e<t.cards.length?i.jsx(Y,{...c,cardStack:t,cardIdx:e,position:a,isPreviousSiblingBeingDragged:s}):t.hasDropTarget&&i.jsx(B,{stackInfo:{stackId:t.stackId,cardIndex:t.cards.length},position:{x:t.position.x,y:t.position.y+t.cards.length*y}})}const V="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='card'%20face='outline'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='transparent'%20stroke='black'%3e%3c/rect%3e%3c/svg%3e";function F({cardStack:t,...e}){return i.jsxs(i.Fragment,{children:[i.jsx("div",{...e,className:"absolute h-36 w-fit",style:{left:`${t.position.x}px`,top:`${t.position.y}px`,zIndex:-10,pointerEvents:"none"},children:i.jsx("img",{src:V,className:"h-full"})}),i.jsx(D,{cardStack:t,cardIdx:0,position:t.position})]})}function U({}){const{canvasRef:t,isCanvasAvailable:e}=x.useCanvas(),{cardStacks:a}=x.useModel();return i.jsx("div",{ref:t,className:"relative",children:e&&a.map(s=>i.jsx(F,{cardStack:s},`card-stack-${s.stackId}`))})}const X=[{stackId:0,cards:[{stackInfo:{stackId:0,cardIndex:0},descriptor:{suit:v.Clubs,rank:1,cardImg:L}},{stackInfo:{stackId:0,cardIndex:1},descriptor:{suit:v.Diamonds,rank:1,cardImg:f}}],hasDropTarget:!0,position:{x:30,y:30}},{stackId:1,cards:[{stackInfo:{stackId:1,cardIndex:0},descriptor:{suit:v.Diamonds,rank:1,cardImg:f}}],hasDropTarget:!0,position:{x:180,y:30}},{stackId:2,cards:[{stackInfo:{stackId:2,cardIndex:0},descriptor:{suit:v.Hearts,rank:1,cardImg:M}}],hasDropTarget:!0,position:{x:330,y:30}},{stackId:3,cards:[{stackInfo:{stackId:3,cardIndex:0},descriptor:{suit:v.Spades,rank:1,cardImg:P}}],hasDropTarget:!0,position:{x:480,y:30}},{stackId:4,cards:[],hasDropTarget:!0,position:{x:30,y:200}},{stackId:5,cards:[],hasDropTarget:!0,position:{x:180,y:200}},{stackId:6,cards:[],hasDropTarget:!0,position:{x:330,y:200}},{stackId:7,cards:[],hasDropTarget:!0,position:{x:480,y:200}}];function $(){return i.jsxs("div",{className:"p-3 select-none",children:[i.jsx("h1",{className:"mb-3",children:"Playing Cards"}),i.jsx("div",{className:"pb-3",children:"The following is an exploration of drag-n-drop behavior while staying within React and not using any dnd libraries and not using the draggable property."}),i.jsx(p,{value:m(X),children:i.jsx(U,{})})]})}const q=$;export{q as component};
