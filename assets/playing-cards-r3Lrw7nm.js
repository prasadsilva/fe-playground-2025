import{r,d as y,j as i}from"./index-DiXbZJ7u.js";const p={Clubs:0,Diamonds:1,Hearts:2,Spades:3},b="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2C'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SC2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M30%20150C35%20385%2085%20400%20130%20500L-130%20500C-85%20400%20-35%20385%20-30%20150A10%2010%200%200%200%20-50%20150A210%20210%200%201%201%20-124%20-51A10%2010%200%200%200%20-110%20-65A230%20230%200%201%201%20110%20-65A10%2010%200%200%200%20124%20-51A210%20210%200%201%201%2050%20150A10%2010%200%200%200%2030%20150Z'%20fill='black'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VC2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='black'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VC2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='70'%20width='70'%20x='-35'%20y='-135.588'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VC2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SC2'%20height='70'%20width='70'%20x='-35'%20y='-135.588'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",f="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2D'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SD2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-400%200C-350%200%200%20-450%200%20-500C0%20-450%20350%200%20400%200C350%200%200%20450%200%20500C0%20450%20-350%200%20-400%200Z'%20fill='red'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VD2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='red'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VD2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VD2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SD2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",S="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2H'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SH2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M0%20-300C0%20-400%20100%20-500%20200%20-500C300%20-500%20400%20-400%20400%20-250C400%200%200%20400%200%20500C0%20400%20-400%200%20-400%20-250C-400%20-400%20-300%20-500%20-200%20-500C-100%20-500%200%20-400%20-0%20-300Z'%20fill='red'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VH2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='red'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VH2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VH2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SH2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3c/g%3e%3c/svg%3e",I="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20class='card'%20face='2S'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3cdefs%3e%3csymbol%20id='SS2'%20viewBox='-600%20-600%201200%201200'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M0%20-500C100%20-250%20355%20-100%20355%20185A150%20150%200%200%201%2055%20185A10%2010%200%200%200%2035%20185C35%20385%2085%20400%20130%20500L-130%20500C-85%20400%20-35%20385%20-35%20185A10%2010%200%200%200%20-55%20185A150%20150%200%200%201%20-355%20185C-355%20-100%20-100%20-250%200%20-500Z'%20fill='black'%3e%3c/path%3e%3c/symbol%3e%3csymbol%20id='VS2'%20viewBox='-500%20-500%201000%201000'%20preserveAspectRatio='xMinYMid'%3e%3cpath%20d='M-225%20-225C-245%20-265%20-200%20-460%200%20-460C%20200%20-460%20225%20-325%20225%20-225C225%20-25%20-225%20160%20-225%20460L225%20460L225%20300'%20stroke='black'%20stroke-width='80'%20stroke-linecap='square'%20stroke-miterlimit='1.5'%20fill='none'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='white'%20stroke='black'%3e%3c/rect%3e%3cuse%20xlink:href='%23VS2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3cg%20transform='rotate(180)'%3e%3cuse%20xlink:href='%23VS2'%20height='32'%20width='32'%20x='-114.4'%20y='-156'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='26.769'%20width='26.769'%20x='-111.784'%20y='-119'%3e%3c/use%3e%3cuse%20xlink:href='%23SS2'%20height='70'%20width='70'%20x='-35'%20y='-135.501'%3e%3c/use%3e%3c/g%3e%3c/svg%3e";class A{trackedObjDragMoveCallback;trackedObjDragEndCallback;canvasPointerClientX;canvasPointerClientY;usageCount;currentDragData;dragStateChangeListeners;dropCallback;constructor(e){this.trackedObjDragMoveCallback=void 0,this.trackedObjDragEndCallback=void 0,this.canvasPointerClientX=-1,this.canvasPointerClientY=-1,this.usageCount=0,this.currentDragData=null,this.dragStateChangeListeners=new Set,this.dropCallback=e}setDragData(e){this.currentDragData=e,this.dragStateChangeListeners.forEach(a=>a(this.currentDragData))}addDragStateChangeListener(e){this.dragStateChangeListeners.add(e),this.usageCount===0&&document.body.addEventListener("pointermove",this.trackCanvasPointer),this.usageCount++}removedragStateChangeListener(e){this.dragStateChangeListeners.delete(e),this.usageCount--,this.usageCount===0&&document.body.removeEventListener("pointermove",this.trackCanvasPointer)}trackCanvasPointer=e=>{const a=e.clientX-this.canvasPointerClientX,s=e.clientY-this.canvasPointerClientY;this.trackedObjDragMoveCallback&&this.trackedObjDragMoveCallback(a,s),this.canvasPointerClientX=e.clientX,this.canvasPointerClientY=e.clientY};registerPointerReleaseCallbacks=()=>{document.body.addEventListener("pointerup",this.handlePointerReleaseNative),document.body.addEventListener("pointerleave",this.handlePointerInvalidNative),document.body.addEventListener("pointercancel",this.handlePointerInvalidNative)};unregisterPointerReleaseCallbacks=()=>{document.body.removeEventListener("pointerup",this.handlePointerReleaseNative),document.body.removeEventListener("pointerleave",this.handlePointerInvalidNative),document.body.removeEventListener("pointercancel",this.handlePointerInvalidNative)};handlePointerReleaseNative=e=>{this.currentDragData&&this.dropCallback(this.currentDragData),this.clearActiveDragHandler()};handlePointerInvalidNative=e=>{this.clearActiveDragHandler()};setActiveDragHandler=(e,a,s)=>{if(this.trackedObjDragMoveCallback){console.warn("Already in drag mode");return}this.trackedObjDragMoveCallback=a,this.trackedObjDragEndCallback=s,this.registerPointerReleaseCallbacks(),this.setDragData(e)};clearActiveDragHandler=()=>{if(!this.trackedObjDragMoveCallback){console.warn("Unable to clear drag object. Not currently dragging an element.");return}this.trackedObjDragMoveCallback=void 0,this.trackedObjDragEndCallback&&this.trackedObjDragEndCallback(),this.trackedObjDragEndCallback=void 0,this.unregisterPointerReleaseCallbacks(),this.setDragData(null)}}class M{cardStacks;changeListeners;dragManager;activeDropTarget;constructor(e){this.cardStacks=y(e),this.changeListeners=new Set,this.dragManager=new A(a=>this.tryHandleDrop(a)),this.activeDropTarget=null}getCardStacks(){return this.cardStacks}setActiveDragHandler(e,a,s){this.dragManager.setActiveDragHandler(e,a,s)}addDragStateChangeListener(e){this.dragManager.addDragStateChangeListener(e)}removeDragStateChangeListener(e){this.dragManager.removedragStateChangeListener(e)}setActiveDropTarget(e){this.activeDropTarget=e}clearActiveDropTarget(){this.activeDropTarget=null}tryHandleDrop(e){this.activeDropTarget?this.moveBetweenStacks(e.stackInfo,this.activeDropTarget):this.fireModelChange(),this.clearActiveDropTarget()}addChangeListener(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}fireModelChange(){this.changeListeners.forEach(e=>e())}moveBetweenStacks(e,a){const s=this.cardStacks.findIndex(h=>h.stackId===e.stackId);if(s===-1){console.warn("Unable to move card. Source stack is invalid");return}const c=this.cardStacks.findIndex(h=>h.stackId===a.stackId);if(c===-1){console.warn("Unable to move card. Target stack is invalid");return}const o=[...this.cardStacks],d={...this.cardStacks[s]},n=[...d.cards],l=n.splice(e.cardIndex,1);l.length!==1&&console.warn("Something went wrong with card removal");for(let h=e.cardIndex;h<n.length;h++){const v={...n[h]};v.stackInfo={stackId:e.stackId,cardIndex:h},n[h]=v}d.cards=n,o[s]=d;const g={...l[0]};g.stackInfo={...a};const x={...this.cardStacks[c]},u=[...x.cards];u.splice(a.cardIndex,0,g),x.cards=u,o[c]=x,this.cardStacks=o,this.fireModelChange()}}const w=t=>new M(t),k=r.createContext(w([]));function L(){const t=r.useContext(k),[e,a]=r.useState(t.getCardStacks()),s=r.useCallback(()=>{a([...t.getCardStacks()])},[t]);return r.useEffect(()=>(t.addChangeListener(s),()=>t.removeChangeListener(s)),[t]),{cardStacks:e}}function D(){const t=r.useContext(k),[e,a]=r.useState(null),s=r.useCallback(n=>{a(n)},[]);r.useEffect(()=>(t.addDragStateChangeListener(s),()=>t.removeDragStateChangeListener(s)),[t]);const c=r.useCallback((n,l,g)=>{t.setActiveDragHandler(n,l,g)},[t]),o=r.useCallback(n=>{t.setActiveDropTarget(n)},[t]),d=r.useCallback(n=>{t.clearActiveDropTarget()},[t]);return{activeDragCard:e,setActiveDrag:c,setActiveDrop:o,unsetActiveDrop:d}}function P(t){const e=r.useRef(null),{activeDragCard:a,setActiveDrop:s,unsetActiveDrop:c}=D(),[o,d]=r.useState(!1),n=r.useMemo(()=>a&&a.stackInfo.stackId!==t.stackId,[a,t]);return r.useEffect(()=>{const l=e.current;if(l){const g=()=>{n&&(d(!0),s(t))},x=()=>{n&&(d(!1),c(t))};return l.addEventListener("pointerenter",g),l.addEventListener("pointerleave",x),()=>{l.removeEventListener("pointerenter",g),l.removeEventListener("pointerleave",x)}}},[e.current,n,t]),r.useEffect(()=>{a||d(!1)},[a]),{dropTargetRef:e,isActivated:n,isDragOver:o}}const C={useModel:L,useDragManager:D,useDropTarget:P};function T({card:t,position:e,...a}){const[s,c]=r.useState(!1),[o,d]=r.useState({x:e.x,y:e.y}),{setActiveDrag:n}=C.useDragManager();r.useEffect(()=>{d(e)},[e]);const l=r.useCallback(u=>{c(!0),n(t,g,x)},[t]),g=r.useCallback((u,h)=>{d(v=>({x:v.x+u,y:v.y+h}))},[]),x=r.useCallback(()=>{c(!1)},[]);return i.jsx("div",{...a,className:"absolute h-36",style:{transform:`translateX(${o.x}px) translateY(${o.y}px)`,zIndex:s?"100":t.stackInfo.cardIndex,pointerEvents:s?"none":"auto"},onPointerDown:l,draggable:!1,children:i.jsx("img",{src:t.descriptor.cardImg,className:"h-full"})})}const E="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='card'%20face='outline'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='%23aaaaaa33'%20stroke='black'%3e%3c/rect%3e%3c/svg%3e";function j({stackInfo:t,position:e,...a}){const{dropTargetRef:s,isActivated:c,isDragOver:o}=C.useDropTarget(t);return i.jsx("div",{...a,ref:s,className:"absolute h-36 w-fit",style:{left:`${e.x}px`,top:`${e.y}px`,zIndex:t.cardIndex,opacity:c&&o?.4:0,pointerEvents:c?"auto":"none"},children:i.jsx("img",{src:E,className:"h-full"})})}const R="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='card'%20face='outline'%20height='3.5in'%20preserveAspectRatio='none'%20viewBox='-120%20-168%20240%20336'%20width='2.5in'%3e%3crect%20width='239'%20height='335'%20x='-119.5'%20y='-167.5'%20rx='12'%20ry='12'%20fill='transparent'%20stroke='black'%3e%3c/rect%3e%3c/svg%3e",m=24;function H({cardStack:t,...e}){return i.jsxs(i.Fragment,{children:[i.jsx("div",{...e,className:"absolute h-36 w-fit",style:{left:`${t.position.x}px`,top:`${t.position.y}px`,zIndex:-10,pointerEvents:"none"},children:i.jsx("img",{src:R,className:"h-full"})}),t.cards.map((a,s)=>i.jsx(T,{card:a,position:{x:t.position.x,y:t.position.y+s*m}},`card${s}-${a.stackInfo.stackId}-${a.stackInfo.cardIndex}`)),t.hasDropTarget&&i.jsx(j,{stackInfo:{stackId:t.stackId,cardIndex:t.cards.length},position:{x:t.position.x,y:t.position.y+t.cards.length*m}})]})}function O({}){const{cardStacks:t}=C.useModel();return i.jsx("div",{className:"relative",children:t.map(e=>i.jsx(H,{cardStack:e},`card-stack-${e.stackId}`))})}const N=[{stackId:0,cards:[{stackInfo:{stackId:0,cardIndex:0},descriptor:{suit:p.Clubs,rank:1,cardImg:b}},{stackInfo:{stackId:0,cardIndex:1},descriptor:{suit:p.Diamonds,rank:1,cardImg:f}}],hasDropTarget:!0,position:{x:30,y:30}},{stackId:1,cards:[{stackInfo:{stackId:1,cardIndex:0},descriptor:{suit:p.Diamonds,rank:1,cardImg:f}}],hasDropTarget:!0,position:{x:180,y:30}},{stackId:2,cards:[{stackInfo:{stackId:2,cardIndex:0},descriptor:{suit:p.Hearts,rank:1,cardImg:S}}],hasDropTarget:!0,position:{x:330,y:30}},{stackId:3,cards:[{stackInfo:{stackId:3,cardIndex:0},descriptor:{suit:p.Spades,rank:1,cardImg:I}}],hasDropTarget:!0,position:{x:480,y:30}},{stackId:4,cards:[],hasDropTarget:!0,position:{x:30,y:200}},{stackId:5,cards:[],hasDropTarget:!0,position:{x:180,y:200}},{stackId:6,cards:[],hasDropTarget:!0,position:{x:330,y:200}},{stackId:7,cards:[],hasDropTarget:!0,position:{x:480,y:200}}];function B(){return i.jsxs("div",{className:"p-3 select-none",children:[i.jsx("h1",{className:"mb-3",children:"Playing Cards"}),i.jsx("div",{className:"pb-3",children:"The following is an exploration of drag-n-drop behavior while staying within React and not using any dnd libraries and not using the draggable property."}),i.jsx(k,{value:w(N),children:i.jsx(O,{})})]})}const V=B;export{V as component};
